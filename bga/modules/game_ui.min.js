const STORAGE_TTL=12e5,GIVEUP_DURATION_STR="6666",GIVEUP_DURATION=6666,MAX_ROUNDS_DISPLAY=10,gameUI={hiddenPlayer:[],teamData:[],history:[],init:function(e){if(this.dojoGame||(this.dojoGame=e,this.playerId=e.player_id,this.isSpectator=e.isSpectator),!window.game)return void setTimeout((function(){gameUI.init(e)}),100);window.game.onLockChange=function(e){const t=e.some((e=>e.some((e=>!!e))));gameUI.lockedCells=t?e:void 0,gameUI.saveLockedCells()},window.game.onGridChange=function(e){if(JSON.stringify(gameUI.grid)!==JSON.stringify(e))if(gameUI.grid&&gameUI.history.push(gameUI.grid),gameUI.setGrid(e),gameUI.saveGrid(),100===gameUI.soloMode){const t=e?window.game.getSeed(e):"",s=gameUI._isSeedValid(t)?t:"";document.getElementById("lrf_design_input").value=s}else gameUI.shouldSendProgression=!0},window.game.onProgression=function(e){gameUI.progression=e},window.game.onPuzzleChange=function(e){"puzzleCreation"===gameUI.mode&&(gameUI.puzzle=e)},window.game.onPuzzleResolve=function(t){"play"===gameUI.mode&&(gameUI.setGrid(t),e.isCurrentPlayerActive()&&"playing"===gameUI.getMyData().state&&(gameUI.resolved=!0))},this.stateEmoticons={teamSelecting:"ü§®",teamSelected:"üëç",failed:"üòï",resting:"üòé",creating:"ü§®",created:"üòé",playing:"ü§®",design:"ü§®",success:"üòé",default:"üò¥"},this.stateLabels={teamSelecting:_("Team selection"),teamSelected:_("Team selected"),failed:_("Failed to solve the puzzle"),resting:_("It's my puzzle"),creating:_("In progress"),created:_("Puzzle created"),playing:_("In progress"),design:_("In progress"),success:_("Success"),default:_("Not yet started")};const securedLive=function(){try{gameUI.live()}catch(e){console.error("Error in gameUI.live",e)}};this.timeLimitStr=this.getDurationStr(60*this.timeLimit),securedLive(),setInterval(securedLive,500),window.game.setSmart(1==e.prefs[100].value),window.game.setHoverDisplay(1==e.prefs[101].value),window.game.setSimplifiedDisplay(2==e.prefs[103].value),window.game.setPartialSolutionAllowed(this.partialSolutionAllowed),this.liveLoop=0,this.initialized=!0},getMyData:function(){return this.players[this.playerId]},initLocalStorage:function(e,t){this.storageKey="lr_"+e+"_"+t,this.lockedStorageKey="lr_l_"+e+"_"+t,this.teamStorageKey="lr_t_"+e+"_"+t;const s=localStorage.length,o=(new Date).getTime(),i=[];for(let e=0;e<s;++e){const t=localStorage.key(e);if(t.startsWith("lr_")){const e=localStorage.getItem(t);JSON.parse(e).expires<o&&i.push(t)}}i.forEach((e=>localStorage.removeItem(e)))},resetLockedCells:function(){try{window.game.resetLockedCells()}catch(e){console.error("Exception occured in resetLockedCells",e)}},reset:function(){if(this.lockedCells&&this.grid){const e=this.grid.map(((e,t)=>e.map(((e,s)=>7===e||this.lockedCells[t][s]?e:0))));this.setGrid(e)}else this.setGrid(void 0);this.setup(),this.saveGrid(),this.history=[],this.shouldSendProgression=!0},undo:function(){if(this.history.length){const e=this.history.pop();this.setGrid(e),this.setup(),this.saveGrid(),this.shouldSendProgression=!0}},saveLockedCells:function(){if(this.lockedCells){const e={lockedCells:this.lockedCells,expires:(new Date).getTime()+12e5};localStorage.setItem(this.lockedStorageKey,JSON.stringify(e))}else localStorage.removeItem(this.lockedStorageKey)},getSavedLockedCells:function(){try{const e=localStorage.getItem(this.lockedStorageKey);if(e){return JSON.parse(e).lockedCells}}catch(e){}},saveGrid:function(){const e={grid:this.grid,expires:(new Date).getTime()+12e5};localStorage.setItem(this.storageKey,JSON.stringify(e))},_saveTeamData:function(){const e={team:this.teamData,expires:(new Date).getTime()+12e5};localStorage.setItem(this.teamStorageKey,JSON.stringify(e))},getSavedGrid:function(){try{const e=localStorage.getItem(this.storageKey);if(e){return JSON.parse(e).grid}}catch(e){}},_getSavedTeamData:function(){try{const e=localStorage.getItem(this.teamStorageKey);if(e){return JSON.parse(e).team}}catch(e){}},clearSavedGrid:function(){localStorage.removeItem(this.storageKey),this.history=[]},clearSavedTeamData:function(){localStorage.removeItem(this.teamStorageKey),this.teamData.forEach((e=>e.grid=void 0))},displayTeamEyes:function(){if(this.realtime&&!this.isSpectator&&!g_archive_mode){const e=this.getMyData().team,t=!this.ended&&(this.samePuzzle&&this.puzzleUser&&this.puzzleUser.id==this.playerId||e&&this.teamData.length&&"success"!==gameUI.players[this.playerId].state);Object.keys(gameUI.players).map((s=>{const o="lrf_disp_"+s;!t||s==this.playerId||e&&!this.teamData.some((e=>e.id==s))?document.getElementById(o).innerHTML="&nbsp;":document.getElementById(o).innerHTML=gameUI.getCheckBox(!gameUI.hiddenPlayer[s],"#000000")+"üëÄ"}))}},teamDisplay:function(e){this.hiddenPlayer[e]=!this.hiddenPlayer[e],this.shouldRefreshProgression=!0,this.refreshTeamData=!0},savePlayerData:function(e,t,s){const o={id:t,color:e.color,progression:parseInt(e.progression,10),grid:e.grid?JSON.parse(e.grid):void 0,puzzle:e.puzzle?JSON.parse(e.puzzle):void 0,name:e.name,startTime:parseInt(e.start,10),team:parseInt(e.team,10),num:parseInt(e.num,10)};o.running=o.startTime>0,o.running?"54"===e.state?o.state="success":o.state="playing":(o.duration=gameUI.getDurationStr(parseInt(e.duration,10)),"90"===e.state?o.state=s?"teamSelecting":"teamSelected":"91"===e.state||"92"===e.state?o.state="teamSelected":"30"===e.state?o.state="creating":"31"===e.state?o.state="created":"52"===e.state?o.state="failed":["51","54","80"].some((t=>e.state===t))&&100===o.progression?o.state="success":"80"===e.state&&"6666"===e.duration?o.state="failed":o.state="unknown"),this.players[t]=o},setCollectiveGiveup:function(e){this.collectiveGiveupTeams=[0].concat(e.teams.map((e=>+e))),this.collectiveGiveupPlayers=[0].concat(e.players.map((e=>+e)))},buildCollectiveGiveupArea:function(){dojo.place(this.dojoGame.format_block("jstpl_giveup",{giveup_decision_title:_("Would you like to giveup this round (you will receive a point penalty)?"),yes:_("Yes"),no:_("No")}),"left-side",12),$("giveup_decision_yes").onclick=function(){gameUI.giveUpPropose=!0},$("giveup_decision_no").onclick=function(){gameUI.giveUpRefuse=!0}},hideCollectiveGiveup:function(){if(this.teamsCount>0){const e=this.getMyData().team;gameUI.collectiveGiveupTeams[e]=0,Object.keys(gameUI.players).map((t=>{gameUI.players[t].team===e&&(gameUI.collectiveGiveupPlayers[gameUI.players[t].num]=0)})),this.displayCollectiveGiveup()}},displayCollectiveGiveup:function(){if(!this.ended&&this.teamsCount>0){const e=this.getMyData().team,t=this.collectiveGiveupTeams[e],s=[];t?(dojo.style("giveup-decision","display",""),Object.keys(this.players).map((t=>{const o=this.players[t].team,i=this.players[t].num,a=this.collectiveGiveupPlayers[i];o===e&&a&&s.push(this.players[t].name)})),document.getElementById("giveup-decision-players").innerHTML=s.join(", ")):dojo.style("giveup-decision","display","none")}},shouldAddTime:function(){if(!this.realtime||"play"!==this.mode)return!1;const e=document.getElementById("timeToThink_"+this.playerId).innerHTML;if(!("-"==e[0]||"0"==e[0]))return!1;const t=(new Date).getTime()/1e3;return!(this.lastAddTime&&t-this.lastAddTime<2)&&(this.lastAddTime=t,!0)},buildProgressionBars:function(){Object.keys(this.players).map((e=>{this.displayProgression(e,this.players[e].progression,this.players[e].startTime,this.players[e].duration)}))},buildTeamData:function(){const e=this._getSavedTeamData();if(e)return this.teamData=e,void(this.refreshTeamData=!0);const t=this.getMyData().team;t&&!this.teamData.length&&Object.keys(this.players).map((e=>{this.playerId!==+e&&this.players[e].team===t&&this.teamData.push({id:e,color:"#"+this.players[e].color})})),this.shouldRefreshProgression=!0},getTeamPlayersId:function(e){const t=[];return Object.keys(this.players).forEach((s=>{this.players[s].team===e&&t.push(s)})),t},_setTeam:function(){if(this.refreshTeamData){try{const e=this.teamData.filter((e=>{const t=this.players[e.id].state;return e.id!=this.playerId&&!this.hiddenPlayer[+e.id]&&("playing"===t||"success"===t)}));window.game.setTeam(e),this._saveTeamData(this.teamData)}catch(e){console.error("Error in setTeam",e,this.teamData)}this.refreshTeamData=!1}},live:function(){if(this.liveLoop=(this.liveLoop+1)%4,this._setTeam(),this.resolved&&(this.resolved=!1,this.giveUp=!1,this.timeout=!1,this.shouldSendProgression=!1,this.clearSavedGrid(),this.callAction("puzzleResolve",{grid:JSON.stringify(this.grid)},!0,"post",(e=>{e&&(this.saveGrid(),setTimeout((()=>{this.resolved=!0}),5e3))}))),this.giveUpPropose)this.giveUpPropose=!1,this.shouldSendProgression=!1,this.callAction("giveUpPropose",{grid:JSON.stringify(gameUI.grid)},!0,"post");else if(this.giveUpRefuse)this.giveUpRefuse=!1,this.shouldSendProgression=!1,this.callAction("giveUpRefuse",null,!0);else if(this.timeout||this.giveUp){const e=this.timeout?"timeout":"giveUp";this.shouldSendProgression=!1,this.giveUp=!1,this.timeout=!1,this.mode="solution",this.callAction(e,{grid:JSON.stringify(this.grid)},!0,"post",(t=>{t&&setTimeout((()=>{"timeout"===e?this.timeout=!0:this.giveUp=!0}),5e3)}))}else 0!==this.liveLoop&&2!==this.liveLoop||"play"!==this.mode||this.manageTimeLimit();if(this.puzzleCreationEnd&&(this.puzzleCreationEnd=!1,this.shouldSendProgression=!1,this.callAction("creationEnd",{grid:JSON.stringify(this.grid),puzzle:JSON.stringify(this.puzzle)},!0,"post"),this.clearSavedGrid()),this.shouldSendProgression&&(0===this.liveLoop||100===this.progression||this.teamData.length)&&(this.shouldSendProgression=!1,this.running&&!g_archive_mode&&("puzzleCreation"===this.mode||"play"===this.mode))){const t={grid:JSON.stringify(this.grid),progression:this.progression||0,give_time:this.shouldAddTime()};if(t.give_time){const e=document.getElementById("page-title");e.style.minHeight=window.getComputedStyle(e,null).getPropertyValue("height")}this.callAction("gridChange",t,t.give_time,"post",(()=>{e.style.minHeight="50px"}))}if(this.shouldRefreshProgression)this.buildProgressionBars(),this.displayBars(),this.displayTeamEyes(),this.shouldRefreshProgression=!1;else if(!this.ended){const e=Math.round((new Date).getTime()/1e3);Object.keys(this.players).map((t=>{const s=this.players[t];if((s.startTime||s.duration)&&(gameUI.realtime||gameUI.playerId==t)){let o=s.duration;o||g_archive_mode||(o=gameUI.getDurationStr(gameUI.getDuration(s.startTime,e))),gameUI._displayDuration(t,o)}}))}const e=document.getElementById("page-title"),t=document.getElementById("maingameview_menuheader"),s=document.getElementById("archivecontrol");let o=e.offsetHeight+90;t&&t.offsetHeight&&(o+=t.offsetHeight+30),s&&s.offsetHeight&&(o+=s.offsetHeight);const i=50*Math.floor(e.offsetWidth/50),a=50*Math.floor((window.innerHeight-o)/50);window.game.setAreaSize(i,a);try{dojo.query(".replay_last_move_button")[0].parentNode.parentNode.style.display="none"}catch(e){}},manageTimeLimit:function(){const e=document.getElementById("giveUp");if(e){const t=this.getMyData();if(t.startTime){const s=gameUI.getDuration(t.startTime),o=60*this.timeLimit-s;o<=0?this.timeout=!0:o<=30&&(e.innerHTML=_("Give up")+" ("+o+")")}}},setGrid:function(e){let t=0;e&&e.forEach((e=>{e.forEach((e=>{e&&7!==e&&t++}))})),this.grid=e,this.placedElements=t},_checkPortals:function(e){if(e&&4===e.length&&!(e[0]<0||e[1]<0||e[2]<0||e[3]<0))return e},isGridCorrect:function(){return!this._checkPortals(this.portals)||!this.grid||7===this.grid[this.portals[0]][this.portals[1]]&&7===this.grid[this.portals[2]][this.portals[3]]},setup:function(e){if(!this.initialized)return void setTimeout((function(){gameUI.setup(e)}),100);"play"!==this.mode&&"empty"!==this.mode||this.isGridCorrect()||(console.error("Invalid grid",this.grid),this.setGrid(void 0),this.saveGrid(),this.history=[]),this.grid&&(this.gridSize=this.grid.length),"play"!==this.mode&&this.lockedCells&&(this.lockedCells=void 0,this.saveLockedCells());const t={mode:this.mode,elements:this.elements,gridSize:this.gridSize,grid:this.grid,puzzle:this.puzzle,portals:this._checkPortals(this.portals),transformations:this.transfo||0,lockedCells:this.lockedCells};e&&Object.keys(e).forEach((s=>t[s]=e[s])),"solution"===this.mode||"solutionOnly"===this.mode?t.solution=this.solution:this.solution=null,this.grid=window.game.setup(t),"empty"===this.mode&&(this.puzzle=void 0),dojo.style("root","visibility","visible"),this.running&&!g_archive_mode||window.game.setRunning(!1)},callAction:function(e,t,s,o,i){this.dojoGame.callAction(e,t,s,o,i)},displayGrid:function(){console.info("## Display grid ##"),this.initialized&&window.game.resetLaser(),dojo.style("lrf_seed","display","none"),100===this.soloMode?(dojo.style("lrf_spectator_design_text","display","flex"),dojo.style("lrf_main","display","none")):!this.isSpectator||this.trainingMode||this.ended?(dojo.style("lrf_spectator_text","display","none"),dojo.style("lrf_main","display","flex")):(dojo.style("lrf_spectator_text","display","flex"),dojo.style("lrf_main","display","none"))},hideGrid:function(){console.info("## Hide grid ##"),dojo.style("lrf_main","display","none")},displayProgression:function(e,t,s,o){try{const i="lrf_info_"+e,a="lrf_progressbar_"+e,r="lrf_counter_"+e,l="lrf_container_"+e,n="lrf_textbar_"+e,d="lrf_emot_"+e,c="lrf_label_"+e,p="lrf_disp_"+e;o||!s||g_archive_mode||(o=this.getDurationStr(this.getDuration(s))),dojo.destroy(i),dojo.place(this.dojoGame.format_block("jstpl_progressbar",{iid:i,pid:a,cid:r,sid:l,tid:n,eid:d,lid:c,did:p,uid:e,color:this.players[e].color,progression:t,dec:100-t,text_disp:t>15?"":"none",counter:o?o+"&nbsp;/&nbsp;"+this.timeLimitStr:""}),"overall_player_board_"+e)}catch(e){console.error("Error in displayProgression",e)}},displayBars:function(){Object.keys(this.players).map((e=>{try{const t="lrf_progressbar_"+e,s="lrf_textbar_"+e,o="lrf_emot_"+e,i="lrf_label_"+e;let a=this.players[e].state;this.samePuzzle&&(this.isSpectator&&this.puzzleUsers&&this.puzzleUsers[e]==e&&(a="resting"),!this.isSpectator&&this.puzzleUser&&this.puzzleUser.id===e&&(a="resting")),document.getElementById(o).innerHTML=this.stateEmoticons[a]||this.stateEmoticons.default,document.getElementById(i).innerHTML=this.stateLabels[a]||this.stateLabels.default,(this.realtime||e==this.playerId)&&["creating","created","playing","success"].some((e=>e===a))?(dojo.style(t,"display",""),dojo.style(s,"display","none")):(dojo.style(t,"display","none"),dojo.style(s,"display",""))}catch(e){console.error("Error in displayBars",e)}}))},_displayDuration:function(e,t){const s="lrf_counter_"+e;try{document.getElementById(s).innerHTML=t+"&nbsp;/&nbsp;"+this.timeLimitStr}catch(e){console.error("Error in _displayDuration",e)}},getDuration:function(e,t){const s=(t||Math.round((new Date).getTime()/1e3))-e-this.serverTimeDec;return s<0?(this.serverTimeDec+=s,0):s},getDurationStr:function(e){if(!e)return"";if(6666===e)return"0:00";const t=e%60;return((e-t)/60).toString()+":"+t.toString().padStart(2,"0")},spyBoard:function(e){if(!this.trainingMode)return dojo.style("lrf_spectator_text","display","flex"),dojo.style("lrf_main","display","none"),void dojo.style("lrf_spectator","display","none");if(dojo.style("lrf_spectator_text","display","none"),dojo.style("lrf_main","display","flex"),dojo.style("lrf_spectator","display",this.playersCount>1?"flex":"none"),e&&(this.playerSpied=e,this.grid=this.players[e].grid),!this.modeRandom)if(this.puzzleUsers){const t=this.puzzleUsers[e];this.puzzle=this.players[t].puzzle}else this.puzzle=void 0;this.dojoGame&&this.setup()},buildRoundsPuzzleSelect:function(){this.resultRoundStart=10===this.puzzles.length&&this.round>10?this.round-10:0;for(let e=0;e<this.puzzles.length;e++)dojo.place("<option value='"+(e+this.resultRoundStart)+"'>"+_("Round")+" "+(e+this.resultRoundStart+1)+"</option>","roundSelect")},buildCopyButton:function(e,t){const s=document.getElementById(e);if(!s.title){const e="<svg aria-hidden='true' height='16' viewBox='0 0 16 16' width='16' data-view-component='true'><path fill-rule='evenodd' d='M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z'></path><path fill-rule='evenodd' d='M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z'></path>",o="<svg aria-hidden='true' height='16' viewBox='0 0 16 16' width='16' data-view-component='true'><g fill='#1a7f37'><path fill-rule='evenodd' d='M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z'></path></g></svg>";s.title=_("Copy to clipboard"),s.innerHTML=e,s.onclick=function(){const i=document.getElementById(t).value;navigator.clipboard.writeText(i).then((()=>{s.innerHTML=o,setTimeout((function(){s.innerHTML=e}),2e3)}))}}},displaySeedArea:function(){dojo.style("lrf_main","display","none"),dojo.style("lrf_seed","display","flex")},displayDesignArea:function(){if(dojo.style("lrf_design","display","flex"),dojo.place("lrf_design","page-title"),this.buildCopyButton("lrf_design_copy","lrf_design_input"),this.initialized)try{const e=this.grid?window.game.getSeed(this.grid):"";this._isSeedValid(e)&&(document.getElementById("lrf_design_input").value=e)}catch(e){}},hideDesignArea:function(){dojo.style("lrf_design","display","none")},_isSeedValid:function(e){let t=!0;const s=[],o=[];let i;try{i=window.game.getGrid(e),i.length<4?t=!1:(i.forEach(((e,i)=>e.forEach(((e,a)=>{e<0?t=!1:7===e?(o.push(i),o.push(a)):e>0&&s.push(e)})))),(0!==o.length&&4!==o.length||4===i.length&&s.length>14||5===i.length&&s.length>20||s.length>30||s.length<3)&&(t=!1))}catch(s){console.warn("Invalid seed code",e),t=!1}return t?[i,s,o]:[void 0,void 0,void 0]},seedValidate:function(e){const[t,s,o]=this._isSeedValid(e);t?(this.elements=s,this.elementsCount=s.length,this.gridSize=t.length,this.portals=this._checkPortals(o),this.callAction("seedValidate",{grid:JSON.stringify(t)},!0,"post")):this.dojoGame.showMessage(_("This is not a valid seed code"),"error")},_displaySeed:function(){window.game?(document.getElementById("lrf_end_seed_input").value=this.grid?window.game.getSeed(this.grid):"",this.buildCopyButton("lrf_end_seed_copy","lrf_end_seed_input")):setTimeout((function(){gameUI._displaySeed()}),500)},displayRoundPuzzle:function(e){console.info("## Display puzzle of round "+e+" ##"),dojo.style("lrf_spectator","display","none"),Object.keys(this.players).forEach((e=>{const t="lrf_end_"+e;document.getElementById(t).innerHTML="?"}));const t=String(e).padStart(4,"0"),s="pd_"+t+"_";this.puzzle=void 0,this.grid=this.puzzles[e-this.resultRoundStart],this._displaySeed(),this.durations.filter((e=>e.pdk.startsWith(s))).forEach((e=>{const t=+e.pdk.substring(s.length),o="lrf_end_"+Object.keys(this.players).map((e=>this.players[e])).find((e=>e.num===t)).id,i="6666"===e.duration?_("Fail"):this.getDurationStr(+e.duration);document.getElementById(o).innerHTML=i}));const o=JSON.stringify(this.grid);Object.keys(this.players).forEach((e=>{const s="pg_"+t+"_"+this.players[e].num;document.getElementById("board_"+e).checked=!1;const i=this.boards.find((e=>e.pgk===s)),a=i&&i.grid?JSON.stringify(i.grid):void 0,r=null==a||a===o?"hidden":"visible";document.getElementById("board_"+e).style.visibility=r}));try{dojo.style("lrf_main","display","flex"),dojo.style("lrf_end","display","flex"),dojo.style("lrf_end_players","display","none"),dojo.style("lrf_end_rounds","display","flex"),this.mode="view",this.solution=null,this.dojoGame&&this.setup()}catch(e){console.error("Error in displayRoundPuzzle",e)}},displayPlayerPuzzle:function(e){console.info("## Display puzzle of player "+e+" ##");try{dojo.style("lrf_spectator","display","none"),dojo.style("lrf_main","display","flex"),dojo.style("lrf_end","display","flex"),dojo.style("lrf_end_players","display","flex"),dojo.style("lrf_end_rounds","display","none");const t=JSON.stringify(this.players[e].grid);Object.keys(this.players).forEach((e=>{const t="lrf_end_"+e;document.getElementById(t).innerHTML="?"})),Object.keys(this.players).forEach((s=>{const o="pg_"+this.players[e].num+"_"+this.players[s].num;document.getElementById("board_"+s).checked=!1;const i=this.boards.find((e=>e.pgk===o)),a=i&&i.grid?JSON.stringify(i.grid):void 0,r=null==a||a===t?"hidden":"visible";document.getElementById("board_"+s).style.visibility=r}));const s="pd_"+this.players[e].num+"_";Object.keys(this.players).forEach((t=>{const s="lrf_end_line_"+t,o=t==e?"none":"";dojo.style(s,"display",o)})),this.durations.filter((e=>e.pdk.startsWith(s))).forEach((e=>{const t=+e.pdk.substring(s.length),o="lrf_end_"+Object.keys(this.players).map((e=>this.players[e])).find((e=>e.num===t)).id,i="6666"===e.duration?_("Fail"):this.getDurationStr(+e.duration);document.getElementById(o).innerHTML=i})),this.mode="view",this.solution=null,this.grid=this.players[e].grid,this._displaySeed(),this.dojoGame&&this.setup()}catch(e){console.error("Error in displayPlayerPuzzle",e)}},displayBoard:function(e){Object.keys(this.players).filter((t=>t!=e)).forEach((e=>document.getElementById("board_"+e).checked=!1)),this.modeRandom?this._displayBoardRound(e):this._displayBoardPlayer(e)},_displayBoardRound:function(e){const t=document.getElementById("roundSelect").value,s=String(t).padStart(4,"0");if(document.getElementById("board_"+e).checked){const o=this.players[e],i="pg_"+s+"_"+o.num,a="pd_"+s+"_"+o.num,r=this.durations.find((e=>e.pdk===a));r&&"6666"!=r.duration?(this.mode="view",this.solution=null):(this.mode="solution",this.solution=this.puzzles[t-this.resultRoundStart]),this.puzzle=void 0,this.grid=this.boards.find((e=>e.pgk===i)).grid,this.dojoGame&&this.setup()}else this.displayRoundPuzzle(t)},_displayBoardPlayer:function(e){const t=document.getElementById("playerSelect").value;if(document.getElementById("board_"+e).checked){const s=this.players[e],o=this.players[t],i="pg_"+o.num+"_"+s.num,a="pd_"+o.num+"_"+s.num,r=this.durations.find((e=>e.pdk===a));r&&"6666"!=r.duration?(this.mode="view",this.solution=null,this.grid=this.boards.find((e=>e.pgk===i)).grid):(this.mode="solution",this.solution=o.grid,this.puzzle=void 0,this.grid=this.boards.find((e=>e.pgk===i)).grid),this.dojoGame&&this.setup()}else this.displayPlayerPuzzle(t)},refreshPuzzle:function(e){try{if(!e&&this.playerSpied&&(e=this.playerSpied),this.playerSpied===e){if(this.grid=this.players[e].grid,!this.modeRandom)if(this.isSpectator&&this.puzzleUsers&&!this.ended){const t=this.puzzleUsers[e];this.puzzle=this.players[t].puzzle}else this.puzzle=void 0;this.setup()}}catch(e){console.error("Error in refreshPuzzle",e)}},displayTeamSelection:function(){dojo.style("lrf_main","display","none"),dojo.style("lrf_teams","display","flex");const e=this.getMyData().team;e&&dojo.addClass("lrf_team_"+e,"lrf_team_selected"),2==this.teamsCount&&dojo.style("lrf_team_3","display","none")},hideTeamSelection:function(){dojo.style("lrf_main","display",""),dojo.style("lrf_teams","display","none")},selectTeam:function(e){for(let t=1;t<=3;t++)e===t?dojo.addClass("lrf_team_"+t,"lrf_team_selected"):dojo.removeClass("lrf_team_"+t,"lrf_team_selected");if(e>0){const t=this.getMyData();t.team!==e&&this.callAction("teamSelect",{no:t.num,team:e},!0)}},displayPlayerTeam:function(e){const t="player_name_"+e,s="icon_team_"+e,o=["","üßô","üßõ","üëΩ"][this.players[e].team];dojo.destroy(s),dojo.place("<span id='"+s+"'>"+o+"&nbsp;</span>",$(t).firstElementChild,0)},displayPlayerHearts:function(e,t){void 0===t&&(t=this.isSpectator?this.playerSpied:this.playerId);const s="player_board_"+t,o="icon_heart_"+t,i=e>=0?e+"&nbsp;üíó":"0&nbsp;üíî";dojo.destroy(o),dojo.place("<span id='"+o+"'>&nbsp;&nbsp;&nbsp;"+i+"&nbsp;</span>",$(s).firstElementChild,4)},displayPlayerIcons:function(){this.soloMode&&this.soloMode<100?this.displayPlayerHearts(this.hearts):this.teamsCount&&Object.keys(this.players).map((e=>{this.displayPlayerTeam(e),this.cooperativeMode&&this.displayPlayerHearts(this.hearts,e)}))},getCheckBox:function(e,t){return e?'<svg width="24px" height="24px" viewBox="0 0 24 24"><g stroke="none" fill="'+t+'" fill-rule="nonzero"><path d="M18.25,3 C19.7687831,3 21,4.23121694 21,5.75 L21,18.25 C21,19.7687831 19.7687831,21 18.25,21 L5.75,21 C4.23121694,21 3,19.7687831 3,18.25 L3,5.75 C3,4.23121694 4.23121694,3 5.75,3 L18.25,3 Z M18.25,4.5 L5.75,4.5 C5.05964406,4.5 4.5,5.05964406 4.5,5.75 L4.5,18.25 C4.5,18.9403559 5.05964406,19.5 5.75,19.5 L18.25,19.5 C18.9403559,19.5 19.5,18.9403559 19.5,18.25 L19.5,5.75 C19.5,5.05964406 18.9403559,4.5 18.25,4.5 Z M10,14.4393398 L16.4696699,7.96966991 C16.7625631,7.6767767 17.2374369,7.6767767 17.5303301,7.96966991 C17.7965966,8.23593648 17.8208027,8.65260016 17.6029482,8.94621165 L17.5303301,9.03033009 L10.5303301,16.0303301 C10.2640635,16.2965966 9.84739984,16.3208027 9.55378835,16.1029482 L9.46966991,16.0303301 L6.46966991,13.0303301 C6.1767767,12.7374369 6.1767767,12.2625631 6.46966991,11.9696699 C6.73593648,11.7034034 7.15260016,11.6791973 7.44621165,11.8970518 L7.53033009,11.9696699 L10,14.4393398 L16.4696699,7.96966991 L10,14.4393398 Z"></path></g></svg>':'<svg width="24px" height="24px" viewBox="0 0 24 24"><g stroke="none" fill="'+t+'" fill-rule="nonzero"><path d="M5.75,3 L18.25,3 C19.7687831,3 21,4.23121694 21,5.75 L21,18.25 C21,19.7687831 19.7687831,21 18.25,21 L5.75,21 C4.23121694,21 3,19.7687831 3,18.25 L3,5.75 C3,4.23121694 4.23121694,3 5.75,3 Z M5.75,4.5 C5.05964406,4.5 4.5,5.05964406 4.5,5.75 L4.5,18.25 C4.5,18.9403559 5.05964406,19.5 5.75,19.5 L18.25,19.5 C18.9403559,19.5 19.5,18.9403559 19.5,18.25 L19.5,5.75 C19.5,5.05964406 18.9403559,4.5 18.25,4.5 L5.75,4.5 Z"></path></g></svg>'},getUnlockIcon:function(){return'<svg width="12px" height="12px" viewBox="0 0 92.179 92.18"><g stroke="none" fill="#ffffff" fill-rule="nonzero"><path d="M73.437,36.54v-9.192C73.437,12.268,61.169,0,46.09,0S18.744,12.268,18.744,27.348h11.355 c0-8.818,7.173-15.992,15.991-15.992c8.817,0,15.991,7.174,15.991,15.992v9.192H9.884v55.64h72.411V36.54H73.437z M50.609,71.115 V83.33h-9.037V71.115c-2.102-1.441-3.482-3.858-3.482-6.6c0-4.418,3.582-8,8-8s8,3.582,8,8 C54.09,67.257,52.71,69.674,50.609,71.115z"/></g></svg>'},getBrowserSvg:function(){const e=window.navigator;if(e.userAgent.toLowerCase().includes("firefox")){const e=window.navigator.userLanguage||window.navigator.language,t='<svg style="padding-top: 40px;" height="80" width="100" viewBox="-4.502953659537916 -1.816370980454367 85.1080168931947 83.43087708452362" xmlns="http://www.w3.org/2000/svg"><linearGradient id="a" x1=".898" x2=".066" y1=".155" y2=".931"><stop offset=".048" stop-color="#fff44f"/><stop offset=".111" stop-color="#ffe847"/><stop offset=".225" stop-color="#ffc830"/><stop offset=".368" stop-color="#ff980e"/><stop offset=".401" stop-color="#ff8b16"/><stop offset=".462" stop-color="#ff672a"/><stop offset=".534" stop-color="#ff3647"/><stop offset=".705" stop-color="#e31587"/></linearGradient><radialGradient id="b" cx="67.813" cy="8.879" gradientUnits="userSpaceOnUse" r="80.797"><stop offset=".129" stop-color="#ffbd4f"/><stop offset=".186" stop-color="#ffac31"/><stop offset=".247" stop-color="#ff9d17"/><stop offset=".283" stop-color="#ff980e"/><stop offset=".403" stop-color="#ff563b"/><stop offset=".467" stop-color="#ff3750"/><stop offset=".71" stop-color="#f5156c"/><stop offset=".782" stop-color="#eb0878"/><stop offset=".86" stop-color="#e50080"/></radialGradient><radialGradient id="c" cx="38.289" cy="41.911" gradientUnits="userSpaceOnUse" r="80.797"><stop offset=".3" stop-color="#960e18"/><stop offset=".351" stop-color="#b11927" stop-opacity=".74"/><stop offset=".435" stop-color="#db293d" stop-opacity=".343"/><stop offset=".497" stop-color="#f5334b" stop-opacity=".094"/><stop offset=".53" stop-color="#ff3750" stop-opacity="0"/></radialGradient><radialGradient id="d" cx="48.03" cy="-9.457" gradientUnits="userSpaceOnUse" r="58.534"><stop offset=".132" stop-color="#fff44f"/><stop offset=".252" stop-color="#ffdc3e"/><stop offset=".506" stop-color="#ff9d12"/><stop offset=".526" stop-color="#ff980e"/></radialGradient><radialGradient id="e" cx="29.352" cy="63.016" gradientUnits="userSpaceOnUse" r="38.471"><stop offset=".353" stop-color="#3a8ee6"/><stop offset=".472" stop-color="#5c79f0"/><stop offset=".669" stop-color="#9059ff"/><stop offset="1" stop-color="#c139e6"/></radialGradient><radialGradient id="f" cx="-7935.62" cy="-8491.546" gradientTransform="matrix(.972 -.235 .275 1.138 10091.302 7833.798)" gradientUnits="userSpaceOnUse" r="20.397"><stop offset=".206" stop-color="#9059ff" stop-opacity="0"/><stop offset=".278" stop-color="#8c4ff3" stop-opacity=".064"/><stop offset=".747" stop-color="#7716a8" stop-opacity=".45"/><stop offset=".975" stop-color="#6e008b" stop-opacity=".6"/></radialGradient><radialGradient id="g" cx="37.269" cy="5.573" gradientUnits="userSpaceOnUse" r="27.676"><stop offset="0" stop-color="#ffe226"/><stop offset=".121" stop-color="#ffdb27"/><stop offset=".295" stop-color="#ffc82a"/><stop offset=".502" stop-color="#ffa930"/><stop offset=".732" stop-color="#ff7e37"/><stop offset=".792" stop-color="#ff7139"/></radialGradient><radialGradient id="h" cx="59.023" cy="-11.981" gradientUnits="userSpaceOnUse" r="118.081"><stop offset=".113" stop-color="#fff44f"/><stop offset=".456" stop-color="#ff980e"/><stop offset=".622" stop-color="#ff5634"/><stop offset=".716" stop-color="#ff3647"/><stop offset=".904" stop-color="#e31587"/></radialGradient><radialGradient id="i" cx="-7927.165" cy="-8522.859" gradientTransform="matrix(.105 .995 -.653 .069 -4684.004 8470.191)" gradientUnits="userSpaceOnUse" r="86.499"><stop offset="0" stop-color="#fff44f"/><stop offset=".06" stop-color="#ffe847"/><stop offset=".168" stop-color="#ffc830"/><stop offset=".304" stop-color="#ff980e"/><stop offset=".356" stop-color="#ff8b16"/><stop offset=".455" stop-color="#ff672a"/><stop offset=".57" stop-color="#ff3647"/><stop offset=".737" stop-color="#e31587"/></radialGradient><radialGradient id="j" cx="36.617" cy="15.824" gradientUnits="userSpaceOnUse" r="73.72"><stop offset=".137" stop-color="#fff44f"/><stop offset=".48" stop-color="#ff980e"/><stop offset=".592" stop-color="#ff5634"/><stop offset=".655" stop-color="#ff3647"/><stop offset=".904" stop-color="#e31587"/></radialGradient><radialGradient id="k" cx="56.077" cy="20.139" gradientUnits="userSpaceOnUse" r="80.686"><stop offset=".094" stop-color="#fff44f"/><stop offset=".231" stop-color="#ffe141"/><stop offset=".509" stop-color="#ffaf1e"/><stop offset=".626" stop-color="#ff980e"/></radialGradient><linearGradient id="l" x1=".888" x2=".18" y1=".151" y2=".835"><stop offset=".167" stop-color="#fff44f" stop-opacity=".8"/><stop offset=".266" stop-color="#fff44f" stop-opacity=".634"/><stop offset=".489" stop-color="#fff44f" stop-opacity=".217"/><stop offset=".6" stop-color="#fff44f" stop-opacity="0"/></linearGradient><path d="M74.62 26.83c-1.7-4.06-5.1-8.43-7.78-9.8a40.27 40.27 0 0 1 3.93 11.75v.07C66.4 17.92 58.97 13.52 52.9 3.92c-.32-.48-.62-.97-.92-1.48-.17-.3-.3-.56-.43-.8A7.05 7.05 0 0 1 50.97.1a.1.1 0 0 0-.08-.1.14.14 0 0 0-.1 0v.02c0 .02-.03 0-.03 0V0c-9.72 5.7-13.03 16.26-13.33 21.53a19.4 19.4 0 0 0-10.67 4.12 11.6 11.6 0 0 0-1-.76 17.97 17.97 0 0 1-.1-9.5 28.7 28.7 0 0 0-9.34 7.22c-1.55-1.94-1.44-8.36-1.35-9.7a6.93 6.93 0 0 0-1.3.68 28.23 28.23 0 0 0-3.8 3.25 33.84 33.84 0 0 0-3.6 4.35 32.73 32.73 0 0 0-5.2 11.74L1 33.2c-.07.33-.34 2.04-.38 2.4v.1A36.94 36.94 0 0 0 0 41.04v.2a38.76 38.76 0 0 0 76.95 6.56c.07-.5.12-1 .18-1.5a39.86 39.86 0 0 0-2.5-19.47zM29.95 57.16c.18.1.35.2.53.27l.03.02q-.27-.14-.55-.3zm40.83-28.32v-.03.04z" fill="url(#a)"/><path d="M74.62 26.83c-1.7-4.06-5.1-8.43-7.78-9.8a40.27 40.27 0 0 1 3.93 11.75v.08a35.1 35.1 0 0 1-1.2 26.16c-4.44 9.53-15.2 19.3-32.03 18.82-18.18-.5-34.2-14-37.2-31.68-.54-2.8 0-4.2.28-6.47A28.88 28.88 0 0 0 0 41.03v.2a38.76 38.76 0 0 0 76.95 6.56c.07-.5.12-1 .18-1.5a39.86 39.86 0 0 0-2.5-19.47z" fill="url(#b)"/><path d="M74.62 26.83c-1.7-4.06-5.1-8.43-7.78-9.8a40.27 40.27 0 0 1 3.93 11.75v.08a35.1 35.1 0 0 1-1.2 26.16c-4.44 9.53-15.2 19.3-32.03 18.82-18.18-.5-34.2-14-37.2-31.68-.54-2.8 0-4.2.28-6.47A28.88 28.88 0 0 0 0 41.03v.2a38.76 38.76 0 0 0 76.95 6.56c.07-.5.12-1 .18-1.5a39.86 39.86 0 0 0-2.5-19.47z" fill="url(#c)"/><path d="M55.78 31.38c.1.06.16.12.24.18a21.1 21.1 0 0 0-3.6-4.7C40.38 14.82 49.27.74 50.77.03V0c-9.72 5.7-13.03 16.26-13.33 21.53.45-.03.9-.06 1.36-.06a19.56 19.56 0 0 1 16.98 9.9z" fill="url(#d)"/><path d="M38.83 33.8c-.07.95-3.47 4.28-4.67 4.28-11.02 0-12.8 6.66-12.8 6.66.48 5.62 4.4 10.24 9.12 12.7l.66.3q.57.25 1.14.47a17.23 17.23 0 0 0 5.04.98c19.32.9 23.06-23.1 9.12-30.07a13.38 13.38 0 0 1 9.34 2.28 19.56 19.56 0 0 0-16.98-9.9c-.46 0-.9.02-1.36.05a19.4 19.4 0 0 0-10.67 4.12c.6.5 1.26 1.16 2.67 2.55 2.63 2.6 9.37 5.27 9.4 5.6z" fill="url(#e)"/><path d="M38.83 33.8c-.07.95-3.47 4.28-4.67 4.28-11.02 0-12.8 6.66-12.8 6.66.48 5.62 4.4 10.24 9.12 12.7l.66.3q.57.25 1.14.47a17.23 17.23 0 0 0 5.04.98c19.32.9 23.06-23.1 9.12-30.07a13.38 13.38 0 0 1 9.34 2.28 19.56 19.56 0 0 0-16.98-9.9c-.46 0-.9.02-1.36.05a19.4 19.4 0 0 0-10.67 4.12c.6.5 1.26 1.16 2.67 2.55 2.63 2.6 9.37 5.27 9.4 5.6z" fill="url(#f)"/><path d="M24.97 24.36c.3.2.57.37.8.53a17.97 17.97 0 0 1-.1-9.5 28.7 28.7 0 0 0-9.34 7.22c.2 0 5.8-.1 8.64 1.74z" fill="url(#g)"/><path d="M.35 42.16c3 17.67 19 31.17 37.2 31.68 16.83.48 27.58-9.3 32.02-18.82a35.1 35.1 0 0 0 1.2-26.16v-.04-.04l.02.07c1.36 8.98-3.2 17.67-10.34 23.55l-.03.05c-13.9 11.33-27.2 6.84-29.9 5q-.3-.13-.57-.28c-8.1-3.87-11.46-11.26-10.74-17.6a9.95 9.95 0 0 1-9.18-5.77 14.62 14.62 0 0 1 14.25-.57 19.3 19.3 0 0 0 14.54.57c-.02-.32-6.76-3-9.4-5.6-1.4-1.38-2.06-2.04-2.66-2.54a11.6 11.6 0 0 0-1-.76c-.23-.16-.48-.33-.8-.53-2.82-1.84-8.44-1.74-8.63-1.74h-.02c-1.53-1.94-1.43-8.36-1.34-9.7a6.93 6.93 0 0 0-1.3.68 28.23 28.23 0 0 0-3.8 3.26 33.84 33.84 0 0 0-3.63 4.34 32.73 32.73 0 0 0-5.2 11.74c-.02.08-1.4 6.1-.72 9.22z" fill="url(#h)"/><path d="M52.43 26.86a21.1 21.1 0 0 1 3.6 4.7c.2.17.4.33.58.48 8.8 8.1 4.2 19.55 3.85 20.37 7.13-5.88 11.7-14.57 10.33-23.55-4.4-10.93-11.82-15.33-17.9-24.93-.3-.48-.6-.97-.9-1.48-.17-.3-.3-.56-.43-.8A7.05 7.05 0 0 1 50.97.1a.1.1 0 0 0-.08-.1.14.14 0 0 0-.1 0v.02c0 .02-.03 0-.03 0-1.5.72-10.4 14.8 1.66 26.84z" fill="url(#i)"/><path d="M56.6 32.04c-.17-.16-.37-.32-.58-.48l-.24-.18a13.38 13.38 0 0 0-9.35-2.27c13.94 6.98 10.2 31-9.12 30.08a17.23 17.23 0 0 1-5.03-.97q-.57-.2-1.14-.46c-.22-.1-.43-.2-.65-.3h.03c2.7 1.84 16 6.34 29.92-5l.02-.04c.35-.8 4.95-12.27-3.84-20.36z" fill="url(#j)"/><path d="M21.35 44.74s1.8-6.66 12.8-6.66c1.2 0 4.6-3.33 4.68-4.3a19.3 19.3 0 0 1-14.56-.56 14.62 14.62 0 0 0-14.25.57 9.95 9.95 0 0 0 9.2 5.76c-.73 6.34 2.62 13.73 10.73 17.6.18.1.35.18.53.27-4.73-2.45-8.64-7.07-9.13-12.7z" fill="url(#k)"/><path d="M74.62 26.83c-1.7-4.06-5.1-8.43-7.78-9.8a40.27 40.27 0 0 1 3.93 11.75v.07C66.4 17.92 58.97 13.52 52.9 3.92c-.32-.48-.62-.97-.92-1.48-.17-.3-.3-.56-.43-.8A7.05 7.05 0 0 1 50.97.1a.1.1 0 0 0-.08-.1.14.14 0 0 0-.1 0v.02c0 .02-.03 0-.03 0V0c-9.72 5.7-13.03 16.26-13.33 21.53.45-.03.9-.06 1.36-.06a19.56 19.56 0 0 1 16.98 9.9 13.38 13.38 0 0 0-9.34-2.26c13.94 6.98 10.2 31-9.12 30.08a17.23 17.23 0 0 1-5.04-.97q-.57-.2-1.14-.46l-.66-.3h.03q-.27-.13-.55-.28c.18.1.35.2.53.27-4.73-2.45-8.64-7.07-9.13-12.7 0 0 1.8-6.65 12.8-6.65 1.2 0 4.6-3.33 4.68-4.3-.02-.3-6.76-3-9.4-5.58-1.4-1.4-2.07-2.05-2.66-2.55a11.6 11.6 0 0 0-1-.76 17.97 17.97 0 0 1-.1-9.5 28.7 28.7 0 0 0-9.34 7.22c-1.55-1.94-1.44-8.36-1.35-9.7a6.93 6.93 0 0 0-1.3.68 28.23 28.23 0 0 0-3.8 3.25 33.84 33.84 0 0 0-3.6 4.35 32.73 32.73 0 0 0-5.2 11.74L1 33.2c-.07.33-.4 2.07-.45 2.44a45.1 45.1 0 0 0-.57 5.4v.2a38.76 38.76 0 0 0 76.95 6.56c.07-.5.12-1 .18-1.5a39.86 39.86 0 0 0-2.5-19.47zm-3.85 2v.03z" fill="url(#l)"/></svg>';return'<div id="lrf-bga-extension" class="roundedbox"><span style="position:absolute; top:0px; left:0px; padding:0.5em">'+(e&&e.startsWith("fr")?'L\'auteur de ce jeu a √©galement cr√©√© une extension Firefox pour BGA. Pour en savoir plus, cliquez <a href="https://addons.mozilla.org/addon/board-game-arena-bga-extension/" target="_blank">ici</a>.</span><a href="#" class="action-button bgabutton bgabutton_blue" onclick="document.getElementById(\'lrf-bga-extension\').style.display=\'none\'" style="position:absolute; bottom:-5px; right:10px;">Non merci</a>':'The author of this game has also created a Firefox extension for BGA. You can find out more <a href="https://addons.mozilla.org/addon/board-game-arena-bga-extension/" target="_blank">here</a>.</span><a href="#" class="action-button bgabutton bgabutton_blue" onclick="document.getElementById(\'lrf-bga-extension\').style.display=\'none\'" style="position:absolute; bottom:-5px; right:10px;">Nope, thanks</a>')+t+"</div>"}const t=window.chrome,s=e.vendor,o=void 0!==window.opr;if(!e.userAgent.match("CriOS")&&null!=t&&"Google Inc."===s&&!1===o){const e=window.navigator.userLanguage||window.navigator.language;return'<div id="lrf-bga-extension" class="roundedbox"><span style="position:absolute; top:0px; left:0px; padding:0.5em">'+(e&&e.startsWith("fr")?'L\'auteur de ce jeu a √©galement cr√©√© une extension Chrome pour BGA. Pour en savoir plus, cliquez <a href="https://chrome.google.com/webstore/detail/bga-chrome-extension/kchnhmpeopknjdjejognciimepllkacb" target="_blank">ici</a>.</span><a href="#" class="action-button bgabutton bgabutton_blue" onclick="document.getElementById(\'lrf-bga-extension\').style.display=\'none\'" style="position:absolute; bottom:-5px; right:10px;">Non merci</a>':'The author of this game has also created a Chrome extension for BGA. You can find out more <a href="https://chrome.google.com/webstore/detail/bga-chrome-extension/kchnhmpeopknjdjejognciimepllkacb" target="_blank">here</a>.</span><a href="#" class="action-button bgabutton bgabutton_blue" onclick="document.getElementById(\'lrf-bga-extension\').style.display=\'none\'" style="position:absolute; bottom:-5px; right:10px;">Nope, thanks</a>')+'<svg height="100" viewBox="20 -20 200 170"><g clip-path="url(#SVGID-00000069372319379759664590000016439136492548043392)"><linearGradient id="SVGID-00000005268409276694585540000015853986965625284781" gradientUnits="userSpaceOnUse" x1="39.16" y1="775.015" x2="152.84" y2="775.015" gradientTransform="matrix(1 0 0 1 0 -650)"><stop offset="0" style="stop-color:#d93025"></stop><stop offset="1" style="stop-color:#ea4335"></stop></linearGradient><path fill="url(#SVGID-00000005268409276694585540000015853986965625284781)" d="M39.16,116.8l9.05,27.61l19.38,21.63 L96,116.81l56.84-0.01C141.49,97.18,120.29,83.99,96,83.99S50.51,97.18,39.16,116.8z"></path><linearGradient id="SVGID-00000175289037886816495430000013271641968500087969" gradientUnits="userSpaceOnUse" x1="-1169.8269" y1="59.7414" x2="-1056.1232" y2="59.7414" gradientTransform="matrix(-0.5 -0.866 0.866 -0.5 -533.5404 -772.0297)"><stop offset="0" style="stop-color:#1e8e3e"></stop><stop offset="1" style="stop-color:#34a853"></stop></linearGradient><path fill="url(#SVGID-00000175289037886816495430000013271641968500087969)" d="M95.99,215.28l19.38-21.64l9.04-27.6H67.58 L39.16,116.8c-11.31,19.64-12.14,44.61,0.01,65.65C51.31,203.49,73.34,215.26,95.99,215.28z"></path><linearGradient id="SVGID-00000025418581839675921930000004546302552040502431" gradientUnits="userSpaceOnUse" x1="56.7071" y1="-664.7747" x2="170.4071" y2="-664.7747" gradientTransform="matrix(-0.5 0.866 -0.866 -0.5 -403.9008 -264.818)"><stop offset="0" style="stop-color:#fbbc04"></stop><stop offset="1" style="stop-color:#fcc934"></stop></linearGradient><path fill="url(#SVGID-00000025418581839675921930000004546302552040502431)" d="M152.84,116.81H96l28.42,49.23L96,215.28 c22.66-0.02,44.69-11.79,56.83-32.83C164.98,161.41,164.15,136.45,152.84,116.81z"></path><ellipse fill="#F1F3F4" cx="96" cy="149.63" rx="32.81" ry="32.82"></ellipse><ellipse fill="#1A73E8" cx="96" cy="149.63" rx="26.66" ry="26.67"></ellipse></g><svg></div>'}},doAdd:function(){if(!localStorage.getItem("lrx_disp")){const e=this.getBrowserSvg();if(e){const t=document.createElement("DIV");t.className="log",t.style.height="auto",t.style.display="block",t.style.color="rgb(0,0,0)",t.innerHTML=e,document.getElementById("chatlogs").prepend(t)}localStorage.setItem("lrx_disp",(new Date).getTime())}}};